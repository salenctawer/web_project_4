"use strict";

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

/*
/ /= ../../node_modules/jquery/dist/jquery.js
 */
var profileContainer = document.querySelector('.profile');
var formRename = document.querySelector('.form-rename');
var closeBtn = document.querySelectorAll('.close');
var formCard = document.querySelector('.form-card');

var saveInfo = function saveInfo(nameValue, descriptionValue) {
  profileContainer.querySelector('.profile-info__name').textContent = nameValue;
  profileContainer.querySelector('.profile-info__description').textContent = descriptionValue;
};

var openInfo = function openInfo(inputNameValue, inputDescriptionValue) {
  formRename.querySelector('#form-name').value = inputNameValue;
  formRename.querySelector('#form-description').value = inputDescriptionValue;
};

var closeFunction = function closeFunction() {
  var _iterator = _createForOfIteratorHelper(closeBtn),
      _step;

  try {
    for (_iterator.s(); !(_step = _iterator.n()).done;) {
      var close = _step.value;
      close.addEventListener('click', function () {
        formRename.classList.remove('--active');
        formCard.classList.remove('--active');
      });
    }
  } catch (err) {
    _iterator.e(err);
  } finally {
    _iterator.f();
  }
};

profileContainer.querySelector('.profile-info__button').addEventListener('click', function () {
  var nameInput = formRename.querySelector('#form-name');
  var descriptionInput = formRename.querySelector('#form-description');
  var nameProfile = profileContainer.querySelector('.profile-info__name');
  var descriptionProfile = profileContainer.querySelector('.profile-info__description');
  openInfo(nameProfile.textContent, descriptionProfile.textContent);
  formRename.classList.add('--active');
  closeFunction();
  formRename.addEventListener('submit', function (e) {
    e.preventDefault();
    saveInfo(nameInput.value, descriptionInput.value);
    formRename.classList.remove('--active');
  });
});
var initialCards = [{
  name: 'Lago di Braies',
  link: 'https://code.s3.yandex.net/web-code/lago.jpg'
}, {
  name: 'Vanoise National Park',
  link: 'https://code.s3.yandex.net/web-code/vanoise.jpg'
}, {
  name: 'Latemar',
  link: 'https://code.s3.yandex.net/web-code/latemar.jpg'
}, {
  name: 'Bald Mountains',
  link: 'https://code.s3.yandex.net/web-code/bald-mountains.jpg'
}, {
  name: 'Lake Louise',
  link: 'https://code.s3.yandex.net/web-code/lake-louise.jpg'
}, {
  name: 'Yosemite Valley',
  link: 'https://code.s3.yandex.net/web-code/yosemite.jpg'
}];

var addNewCard = function addNewCard(elementLink, elementName) {
  var cardTemplate = document.querySelector('#card-template').content;
  var cardElement = cardTemplate.querySelector('.grid-element').cloneNode(true);
  cardElement.querySelector('.grid-element__img').style.backgroundImage = 'url(' + elementLink + ')';
  cardElement.querySelector('.title').textContent = elementName;
  document.querySelector('.grid').prepend(cardElement);
  cardElement.querySelector('.grid-element__trash').addEventListener('click', function (e) {
    e.stopPropagation();
    e.target.parentNode.parentNode.parentNode.removeChild(e.target.parentNode.parentNode);
  });
  cardElement.querySelector('.grid-element__like').addEventListener('click', function (e) {
    e.target.classList.toggle('grid-element__like_active');
  });
};

var addCard = function addCard() {
  initialCards.forEach(function (element) {
    addNewCard(element.link, element.name);
  });
};

addCard();
profileContainer.querySelector('.add-button').addEventListener('click', function () {
  formCard.classList.add('--active');
  closeFunction();
});
formCard.addEventListener('submit', function (e) {
  var titleCard = formCard.querySelector('#card-title');
  var linkCard = formCard.querySelector('#card-link');
  addNewCard(linkCard.value, titleCard.value);
  e.preventDefault();
  formCard.classList.remove('--active');
});

var openPhoto = function openPhoto(photoLink, photoTitle) {
  var photoTemplate = document.querySelector('#photo-template').content;
  var photoContent = photoTemplate.querySelector('.photo-content').cloneNode(true);
  photoContent.querySelector('.photo-element__img').style.backgroundImage = photoLink;
  photoContent.querySelector('.photo-element__title').textContent = photoTitle;
  var closePhoto = photoContent.querySelector('.close');
  closePhoto.addEventListener('click', function () {
    closePhoto.parentNode.parentNode.parentNode.parentNode.parentNode.removeChild(closePhoto.parentNode.parentNode.parentNode.parentNode);
  });
  document.querySelector('.body').prepend(photoContent);
};

var clickPhoto = function clickPhoto() {
  var photoGrid = document.querySelectorAll('.grid-element__img');

  var _iterator2 = _createForOfIteratorHelper(photoGrid),
      _step2;

  try {
    var _loop = function _loop() {
      var photo = _step2.value;
      photo.addEventListener('click', function () {
        var srcContainer = photo.style.backgroundImage;
        var titleGrid = document.querySelector('.grid-element .title').textContent;
        openPhoto(srcContainer, titleGrid);
      });
    };

    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
      _loop();
    }
  } catch (err) {
    _iterator2.e(err);
  } finally {
    _iterator2.f();
  }
};

clickPhoto(); // enableValidation({
//     formSelector: '.popup__form',
//     inputSelector: '.form__input',
//     submitButtonSelector: '.form__button',
//     inactiveButtonClass: 'form__button_disabled',
//     inputErrorClass: 'form__input_type_error',
//     errorClass: 'form__error_visible'
// }); 

var showInputError = function showInputError(formElement, inputElement, errorMessage) {
  var errorElement = formElement.querySelector(".".concat(inputElement.id, "-error"));
  inputElement.classList.add('form__input_type_error');
  errorElement.textContent = errorMessage;
  errorElement.classList.add('form__input-error_active');
};

var hideInputError = function hideInputError(formElement, inputElement) {
  var errorElement = formElement.querySelector(".".concat(inputElement.id, "-error"));
  inputElement.classList.remove('form__input_type_error');
  errorElement.classList.remove('form__input-error_active');
  errorElement.textContent = '';
};

var checkInputValidity = function checkInputValidity(formElement, inputElement) {
  if (!inputElement.validity.valid) {
    showInputError(formElement, inputElement, inputElement.validationMessage);
  } else {
    hideInputError(formElement, inputElement);
  }
};

var setEventListeners = function setEventListeners(formElement) {
  var inputList = Array.from(formElement.querySelectorAll('.form__input'));
  inputList.forEach(function (inputElement) {
    inputElement.addEventListener('input', function () {
      checkInputValidity(formElement, inputElement);
    });
  });
};

var enableValidation = function enableValidation() {
  var formList = Array.from(document.querySelectorAll('.form'));
  formList.forEach(function (formElement) {
    formElement.addEventListener('submit', function (evt) {
      evt.preventDefault();
    });
    setEventListeners(formElement);
  });
};

enableValidation();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInByb2ZpbGVDb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJmb3JtUmVuYW1lIiwiY2xvc2VCdG4iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9ybUNhcmQiLCJzYXZlSW5mbyIsIm5hbWVWYWx1ZSIsImRlc2NyaXB0aW9uVmFsdWUiLCJ0ZXh0Q29udGVudCIsIm9wZW5JbmZvIiwiaW5wdXROYW1lVmFsdWUiLCJpbnB1dERlc2NyaXB0aW9uVmFsdWUiLCJ2YWx1ZSIsImNsb3NlRnVuY3Rpb24iLCJjbG9zZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwibmFtZVByb2ZpbGUiLCJkZXNjcmlwdGlvblByb2ZpbGUiLCJhZGQiLCJlIiwicHJldmVudERlZmF1bHQiLCJpbml0aWFsQ2FyZHMiLCJuYW1lIiwibGluayIsImFkZE5ld0NhcmQiLCJlbGVtZW50TGluayIsImVsZW1lbnROYW1lIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImNhcmRFbGVtZW50IiwiY2xvbmVOb2RlIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJwcmVwZW5kIiwic3RvcFByb3BhZ2F0aW9uIiwidGFyZ2V0IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwidG9nZ2xlIiwiYWRkQ2FyZCIsImZvckVhY2giLCJlbGVtZW50IiwidGl0bGVDYXJkIiwibGlua0NhcmQiLCJvcGVuUGhvdG8iLCJwaG90b0xpbmsiLCJwaG90b1RpdGxlIiwicGhvdG9UZW1wbGF0ZSIsInBob3RvQ29udGVudCIsImNsb3NlUGhvdG8iLCJjbGlja1Bob3RvIiwicGhvdG9HcmlkIiwicGhvdG8iLCJzcmNDb250YWluZXIiLCJ0aXRsZUdyaWQiLCJzaG93SW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJoaWRlSW5wdXRFcnJvciIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNldEV2ZW50TGlzdGVuZXJzIiwiaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwiZW5hYmxlVmFsaWRhdGlvbiIsImZvcm1MaXN0IiwiZXZ0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBLElBQU1BLGdCQUFnQixHQUFHQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsVUFBdkIsQ0FBekI7QUFDQSxJQUFNQyxVQUFVLEdBQUdGLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixjQUF2QixDQUFuQjtBQUNBLElBQU1FLFFBQVEsR0FBR0gsUUFBUSxDQUFDSSxnQkFBVCxDQUEwQixRQUExQixDQUFqQjtBQUNBLElBQU1DLFFBQVEsR0FBR0wsUUFBUSxDQUFDQyxhQUFULENBQXVCLFlBQXZCLENBQWpCOztBQUVBLElBQUlLLFFBQVEsR0FBRyxTQUFYQSxRQUFXLENBQUNDLFNBQUQsRUFBWUMsZ0JBQVosRUFBZ0M7QUFDM0NULEVBQUFBLGdCQUFnQixDQUFDRSxhQUFqQixDQUErQixxQkFBL0IsRUFBc0RRLFdBQXRELEdBQW9FRixTQUFwRTtBQUNBUixFQUFBQSxnQkFBZ0IsQ0FBQ0UsYUFBakIsQ0FBK0IsNEJBQS9CLEVBQTZEUSxXQUE3RCxHQUEyRUQsZ0JBQTNFO0FBQ0gsQ0FIRDs7QUFJQSxJQUFJRSxRQUFRLEdBQUcsU0FBWEEsUUFBVyxDQUFDQyxjQUFELEVBQWlCQyxxQkFBakIsRUFBMEM7QUFDckRWLEVBQUFBLFVBQVUsQ0FBQ0QsYUFBWCxDQUF5QixZQUF6QixFQUF1Q1ksS0FBdkMsR0FBK0NGLGNBQS9DO0FBQ0FULEVBQUFBLFVBQVUsQ0FBQ0QsYUFBWCxDQUF5QixtQkFBekIsRUFBOENZLEtBQTlDLEdBQXNERCxxQkFBdEQ7QUFDSCxDQUhEOztBQUlBLElBQUlFLGFBQWEsR0FBRyxTQUFoQkEsYUFBZ0IsR0FBSztB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R0FBRyxTQUFuQkEsZ0JBQW1CLEdBQU07QUFDM0IsTUFBTUMsUUFBUSxHQUFHSCxLQUFLLENBQUNDLElBQU4sQ0FBVzFFLFFBQVEsQ0FBQ0ksZ0JBQVQsQ0FBMEIsT0FBMUIsQ0FBWCxDQUFqQjtBQUNBd0UsRUFBQUEsUUFBUSxDQUFDL0IsT0FBVCxDQUFpQixVQUFDZ0IsV0FBRCxFQUFpQjtBQUM5QkEsSUFBQUEsV0FBVyxDQUFDN0MsZ0JBQVosQ0FBNkIsUUFBN0IsRUFBdUMsVUFBQzZELEdBQUQsRUFBUztBQUM1Q0EsTUFBQUEsR0FBRyxDQUFDcEQsY0FBSjtBQUNILEtBRkQ7QUFHQThDLElBQUFBLGlCQUFpQixDQUFDVixXQUFELENBQWpCO0FBQ0gsR0FMRDtBQU1ILENBUkQ7O0FBU0FjLGdCQUFnQiIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4vIC89IC4uLy4uL25vZGVfbW9kdWxlcy9qcXVlcnkvZGlzdC9qcXVlcnkuanNcclxuICovXHJcbmNvbnN0IHByb2ZpbGVDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZScpO1xyXG5jb25zdCBmb3JtUmVuYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tcmVuYW1lJyk7XHJcbmNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNsb3NlJyk7XHJcbmNvbnN0IGZvcm1DYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tY2FyZCcpO1xyXG5cclxubGV0IHNhdmVJbmZvID0gKG5hbWVWYWx1ZSwgZGVzY3JpcHRpb25WYWx1ZSkgPT57XHJcbiAgICBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlLWluZm9fX25hbWUnKS50ZXh0Q29udGVudCA9IG5hbWVWYWx1ZTtcclxuICAgIHByb2ZpbGVDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGUtaW5mb19fZGVzY3JpcHRpb24nKS50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uVmFsdWU7XHJcbn07XHJcbmxldCBvcGVuSW5mbyA9IChpbnB1dE5hbWVWYWx1ZSwgaW5wdXREZXNjcmlwdGlvblZhbHVlKSA9PntcclxuICAgIGZvcm1SZW5hbWUucXVlcnlTZWxlY3RvcignI2Zvcm0tbmFtZScpLnZhbHVlID0gaW5wdXROYW1lVmFsdWU7XHJcbiAgICBmb3JtUmVuYW1lLnF1ZXJ5U2VsZWN0b3IoJyNmb3JtLWRlc2NyaXB0aW9uJykudmFsdWUgPSBpbnB1dERlc2NyaXB0aW9uVmFsdWU7XHJcbn07XHJcbmxldCBjbG9zZUZ1bmN0aW9uID0gKCkgPT57XHJcbiAgICBmb3IgKGxldCBjbG9zZSBvZiBjbG9zZUJ0bil7XHJcbiAgICAgICAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xyXG4gICAgICAgICAgICBmb3JtUmVuYW1lLmNsYXNzTGlzdC5yZW1vdmUoJy0tYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIGZvcm1DYXJkLmNsYXNzTGlzdC5yZW1vdmUoJy0tYWN0aXZlJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07XHJcbnByb2ZpbGVDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGUtaW5mb19fYnV0dG9uJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xyXG4gICAgY29uc3QgbmFtZUlucHV0ID0gZm9ybVJlbmFtZS5xdWVyeVNlbGVjdG9yKCcjZm9ybS1uYW1lJyk7XHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbklucHV0ID0gZm9ybVJlbmFtZS5xdWVyeVNlbGVjdG9yKCcjZm9ybS1kZXNjcmlwdGlvbicpO1xyXG4gICAgY29uc3QgbmFtZVByb2ZpbGUgPSBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlLWluZm9fX25hbWUnKTtcclxuICAgIGNvbnN0IGRlc2NyaXB0aW9uUHJvZmlsZSA9IHByb2ZpbGVDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGUtaW5mb19fZGVzY3JpcHRpb24nKTtcclxuICAgIG9wZW5JbmZvKG5hbWVQcm9maWxlLnRleHRDb250ZW50LCBkZXNjcmlwdGlvblByb2ZpbGUudGV4dENvbnRlbnQpO1xyXG4gICAgZm9ybVJlbmFtZS5jbGFzc0xpc3QuYWRkKCctLWFjdGl2ZScpO1xyXG4gICAgY2xvc2VGdW5jdGlvbigpO1xyXG4gICAgZm9ybVJlbmFtZS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSk9PntcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgc2F2ZUluZm8obmFtZUlucHV0LnZhbHVlLCBkZXNjcmlwdGlvbklucHV0LnZhbHVlKTtcclxuICAgICAgICBmb3JtUmVuYW1lLmNsYXNzTGlzdC5yZW1vdmUoJy0tYWN0aXZlJyk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5sZXQgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICdMYWdvIGRpIEJyYWllcycsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAnVmFub2lzZSBOYXRpb25hbCBQYXJrJyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGcnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICdMYXRlbWFyJyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGcnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICdCYWxkIE1vdW50YWlucycsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZydcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogJ0xha2UgTG91aXNlJyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAnWW9zZW1pdGUgVmFsbGV5JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnJ1xyXG4gICAgfVxyXG5dOyBcclxubGV0IGFkZE5ld0NhcmQgPSAoZWxlbWVudExpbmssIGVsZW1lbnROYW1lKSA9PntcclxuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYXJkLXRlbXBsYXRlJykuY29udGVudDtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5ncmlkLWVsZW1lbnQnKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ3JpZC1lbGVtZW50X19pbWcnKS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAndXJsKCcrIGVsZW1lbnRMaW5rICsgJyknO1xyXG4gICAgY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnRpdGxlJykudGV4dENvbnRlbnQgPSBlbGVtZW50TmFtZTtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkJykucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ3JpZC1lbGVtZW50X190cmFzaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT57XHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUpO1xyXG4gICAgfSk7XHJcbiAgICBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ3JpZC1lbGVtZW50X19saWtlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PiB7XHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnZ3JpZC1lbGVtZW50X19saWtlX2FjdGl2ZScpO1xyXG4gICAgfSk7XHJcbn07XHJcbmxldCBhZGRDYXJkID0gKCkgPT57XHJcbiAgICBpbml0aWFsQ2FyZHMuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICBhZGROZXdDYXJkKGVsZW1lbnQubGluaywgZWxlbWVudC5uYW1lKTtcclxuICAgIH0pO1xyXG59O1xyXG5hZGRDYXJkKCk7XHJcblxyXG5cclxucHJvZmlsZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYWRkLWJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PntcclxuICAgIGZvcm1DYXJkLmNsYXNzTGlzdC5hZGQoJy0tYWN0aXZlJyk7XHJcbiAgICBjbG9zZUZ1bmN0aW9uKCk7XHJcbn0pO1xyXG5cclxuZm9ybUNhcmQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpPT57XHJcbiAgICBjb25zdCB0aXRsZUNhcmQgPSBmb3JtQ2FyZC5xdWVyeVNlbGVjdG9yKCcjY2FyZC10aXRsZScpO1xyXG4gICAgY29uc3QgbGlua0NhcmQgPSBmb3JtQ2FyZC5xdWVyeVNlbGVjdG9yKCcjY2FyZC1saW5rJyk7XHJcbiAgICBhZGROZXdDYXJkKGxpbmtDYXJkLnZhbHVlLCB0aXRsZUNhcmQudmFsdWUpO1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgZm9ybUNhcmQuY2xhc3NMaXN0LnJlbW92ZSgnLS1hY3RpdmUnKTtcclxufSk7XHJcblxyXG5sZXQgb3BlblBob3RvID0gKHBob3RvTGluaywgcGhvdG9UaXRsZSkgPT57XHJcbiAgICBjb25zdCBwaG90b1RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Bob3RvLXRlbXBsYXRlJykuY29udGVudDtcclxuICAgIGNvbnN0IHBob3RvQ29udGVudCA9IHBob3RvVGVtcGxhdGUucXVlcnlTZWxlY3RvcignLnBob3RvLWNvbnRlbnQnKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICBwaG90b0NvbnRlbnQucXVlcnlTZWxlY3RvcignLnBob3RvLWVsZW1lbnRfX2ltZycpLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IHBob3RvTGluaztcclxuICAgIHBob3RvQ29udGVudC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZWxlbWVudF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHBob3RvVGl0bGU7XHJcbiAgICBjb25zdCBjbG9zZVBob3RvID0gcGhvdG9Db250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZScpO1xyXG4gICAgY2xvc2VQaG90by5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XHJcbiAgICAgICAgY2xvc2VQaG90by5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY2xvc2VQaG90by5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlKTtcclxuICAgICAgICBcclxuICAgIH0pO1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvZHknKS5wcmVwZW5kKHBob3RvQ29udGVudCk7XHJcbn07XHJcbmxldCBjbGlja1Bob3RvID0gKCkgPT57XHJcbiAgICBjb25zdCBwaG90b0dyaWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZC1lbGVtZW50X19pbWcnKTtcclxuICAgIGZvciAobGV0IHBob3RvIG9mIHBob3RvR3JpZCl7XHJcbiAgICAgICAgcGhvdG8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xyXG4gICAgICAgICAgICBjb25zdCBzcmNDb250YWluZXIgPSBwaG90by5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHRpdGxlR3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkLWVsZW1lbnQgLnRpdGxlJykudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgIG9wZW5QaG90byhzcmNDb250YWluZXIsIHRpdGxlR3JpZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5jbGlja1Bob3RvKCk7XHJcbi8vIGVuYWJsZVZhbGlkYXRpb24oe1xyXG4vLyAgICAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcclxuLy8gICAgIGlucHV0U2VsZWN0b3I6ICcuZm9ybV9faW5wdXQnLFxyXG4vLyAgICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcuZm9ybV9fYnV0dG9uJyxcclxuLy8gICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdmb3JtX19idXR0b25fZGlzYWJsZWQnLFxyXG4vLyAgICAgaW5wdXRFcnJvckNsYXNzOiAnZm9ybV9faW5wdXRfdHlwZV9lcnJvcicsXHJcbi8vICAgICBlcnJvckNsYXNzOiAnZm9ybV9fZXJyb3JfdmlzaWJsZSdcclxuLy8gfSk7IFxyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZm9ybV9faW5wdXRfdHlwZV9lcnJvcicpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Zvcm1fX2lucHV0LWVycm9yX2FjdGl2ZScpO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Zvcm1fX2lucHV0X3R5cGVfZXJyb3InKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmUnKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybV9faW5wdXQnKSk7XHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybScpKTtcclxuICAgIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICAgICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCk7XHJcbiAgICB9KTtcclxufTtcclxuZW5hYmxlVmFsaWRhdGlvbigpOyJdfQ==
